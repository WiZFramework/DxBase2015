<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Trからのぷろansitional//EN">
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="css/main.css" rel="stylesheet" type="text/css">
<title>DxBase2015ドキュメント(2015年)</title>
</head>
<body>
<!-- 全体コンテナ　-->
<div id="container">
<div id="header">
<h2>４．独自の頂点と独自描画</h2>
</div>
<!-- コンテンツ　-->
<div id="contents">
<br/>
<h3>４０９．ジオメトリシェーダの利用２</h3>
<br />
<h4>三角形から四面体を作成する</h4>
　<b>ジオメトリシェーダ</b>の利用方法として、もう一つ、<b>三角形から四面体を作成する</b>サンプルを紹介します。<br />
　このサンプルは<b>マイクロソフト社のDirectX11チュートリアルサンプル</b>を、少し修正した<b>ジオメトリシェーダ</b>を使用しています。<br />
　<b>Sample409ディレクトリ</b>のソリューションを開き、リビルド実行すると以下の画面が現れます。
<p>&nbsp;</p>
<img src="img/4009a.jpg" width="80%"/>
<p>図4009a</p>
<p>&nbsp;</p>
　画面奥に、ギザギザになりながら回転する球体があります。この<b>ギザギザにする処理</b>をジオメトリシェーダ</b>によって行ってます。<br />
　ポイントは、<b>GSBall.hlsl</b>の以下の部分です。
<div class="box1">
<pre>
    float3 faceEdgeA = input[1].Pos.xyz - input[0].Pos.xyz;
    float3 faceEdgeB = input[2].Pos.xyz - input[0].Pos.xyz;
    <span class="red">float3 faceNormal = normalize(cross(faceEdgeA, faceEdgeB));</span>
    float3 ExplodeAmt = faceNormal*Explode;
</pre>
</div>
　この赤くなっているところの処理で、三角形の２辺から外積を計算し法線を導き出します。<br />
　その後、その法線方向に距離（Explode）を伸ばし飛び出す頂点を計算します。<br />
　そうして作成した頂点に向かって、三角形の各頂点から新たな三角形を作って、出力します。こうして、<b>飛び出す頂点</b>を作成しています。<br />
<br />
　ほかの、シェーダを作成したり、あるいはcppから呼び出す方法などは、これまでのサンプルでもいろいろ紹介しましたのでそちらを参照ください。<br />
　ジオメトリシェーダは、前項の、<b>あらたに三角形を別の場所に作る</b>方法と、このサンプルのように、<b>渡された三角形を変形（あるいは利用して）、あらたな頂点そして三角形を作る</b>方法があります。<br />
　このサンプルの手法を応用すると、たとえば、１つの四角形（つまり２つの三角形）を２つ、４つ、８つのように分解していって、１つの立方体を８×８×８の立方体に分解するような処理も可能です。<br />
　前項にも述べましたが、ジオメトリシェーダの利用は<b>アイディア次第</b>です。いろいろ挑戦してみましょう。<br />
<br />
</div>
<!-- /コンテンツ　-->
<hr>
<!-- フッタ　-->
<ul class="foot_navi">
<li><a href="40_08.html">前ページ</a></li>
<li><a href="index.html">目次</a></li>
</ul>
<!-- /フッタ　-->


</div>
<!-- /全体コンテナ　-->
</body>
</html>
